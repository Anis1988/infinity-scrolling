{"ast":null,"code":"import _toConsumableArray from\"/Users/anismedini/Downloads/infinity-scrolling-js/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/anismedini/Downloads/infinity-scrolling-js/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import axios from'axios';export default function useBookSearch(query,pageNumber){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),books=_useState6[0],setBooks=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),hasMore=_useState8[0],setHasMore=_useState8[1];useEffect(function(){setLoading(true);setError(false);var cancel;axios({methode:\"GET\",url:\"http://openlibrary.org/search.json\",params:{q:query,page:pageNumber},// that how they called id \"params\",\"q\",\"page\"\ncancelToken:new axios.CancelToken(function(c){return cancel=c;})}).then(function(res){console.log(res.data);setBooks(function(prevBooks){return _toConsumableArray(new Set([].concat(_toConsumableArray(prevBooks),_toConsumableArray(res.data.docs.map(function(t){return t.title;})))));//unique set\nconsole.log(res.data);});setHasMore(res.data.length>0);setLoading(false);setError(false);}).catch(function(e){if(axios.isCancel(e))return;//this is meant to ignore all the cancellation we meant to cancel\nsetError(true);});return function(){return cancel();};},[query,pageNumber]);useEffect(function(){setBooks([]);},[query]);return{loading:loading,error:error,hasMore:hasMore,books:books};}","map":{"version":3,"sources":["/Users/anismedini/Downloads/infinity-scrolling-js/src/useBookSearch.js"],"names":["React","useState","useEffect","axios","useBookSearch","query","pageNumber","loading","setLoading","error","setError","books","setBooks","hasMore","setHasMore","cancel","methode","url","params","q","page","cancelToken","CancelToken","c","then","res","console","log","data","prevBooks","Set","docs","map","t","title","length","catch","e","isCancel"],"mappings":"gRAAA,MAAOA,CAAAA,KAAP,EAAeC,QAAf,CAAwBC,SAAxB,KAAuC,OAAvC,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAEA,cAAe,SAASC,CAAAA,aAAT,CAAuBC,KAAvB,CAA6BC,UAA7B,CAAyC,eAC5BL,QAAQ,CAAC,IAAD,CADoB,wCAClDM,OADkD,eAC1CC,UAD0C,8BAEhCP,QAAQ,CAAC,KAAD,CAFwB,yCAElDQ,KAFkD,eAE5CC,QAF4C,8BAGhCT,QAAQ,CAAC,EAAD,CAHwB,yCAGlDU,KAHkD,eAG5CC,QAH4C,8BAI5BX,QAAQ,CAAC,KAAD,CAJoB,yCAIlDY,OAJkD,eAI1CC,UAJ0C,eAOpDZ,SAAS,CAAC,UAAI,CACVM,UAAU,CAAC,IAAD,CAAV,CACAE,QAAQ,CAAC,KAAD,CAAR,CAEA,GAAIK,CAAAA,MAAJ,CACAZ,KAAK,CAAC,CACFa,OAAO,CAAC,KADN,CAEFC,GAAG,CAAC,oCAFF,CAGFC,MAAM,CAAC,CAACC,CAAC,CAACd,KAAH,CAAUe,IAAI,CAACd,UAAf,CAHL,CAGiC;AACnCe,WAAW,CAAE,GAAIlB,CAAAA,KAAK,CAACmB,WAAV,CAAsB,SAAAC,CAAC,QAAGR,CAAAA,MAAM,CAAGQ,CAAZ,EAAvB,CAJX,CAAD,CAAL,CAKGC,IALH,CAKQ,SAAAC,GAAG,CAAG,CACVC,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACAhB,QAAQ,CAAC,SAAAiB,SAAS,CAAI,CAClB,0BAAW,GAAIC,CAAAA,GAAJ,8BAAYD,SAAZ,qBAAyBJ,GAAG,CAACG,IAAJ,CAASG,IAAT,CAAcC,GAAd,CAAkB,SAAAC,CAAC,QAAEA,CAAAA,CAAC,CAACC,KAAJ,EAAnB,CAAzB,GAAX,EAAqE;AACrER,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,IAAhB,EACH,CAHO,CAAR,CAIAd,UAAU,CAACW,GAAG,CAACG,IAAJ,CAASO,MAAT,CAAkB,CAAnB,CAAV,CACA3B,UAAU,CAAC,KAAD,CAAV,CACAE,QAAQ,CAAC,KAAD,CAAR,CACH,CAdD,EAcG0B,KAdH,CAcS,SAAAC,CAAC,CAAG,CACT,GAAGlC,KAAK,CAACmC,QAAN,CAAeD,CAAf,CAAH,CAAsB,OAAO;AAC7B3B,QAAQ,CAAC,IAAD,CAAR,CACH,CAjBD,EAkBA,MAAO,kBAAMK,CAAAA,MAAM,EAAZ,EAAP,CACH,CAxBQ,CAwBP,CAACV,KAAD,CAAOC,UAAP,CAxBO,CAAT,CA0BAJ,SAAS,CAAC,UAAI,CACVU,QAAQ,CAAC,EAAD,CAAR,CACH,CAFQ,CAEP,CAACP,KAAD,CAFO,CAAT,CAIA,MAAM,CAACE,OAAO,CAAPA,OAAD,CAASE,KAAK,CAALA,KAAT,CAAeI,OAAO,CAAPA,OAAf,CAAuBF,KAAK,CAALA,KAAvB,CAAN,CAEH","sourcesContent":["import React, {useState,useEffect}from \"react\";\nimport axios from 'axios';\n\nexport default function useBookSearch(query,pageNumber) {\nconst[loading,setLoading] = useState(true)\nconst[error,setError] = useState(false)\nconst[books,setBooks] = useState([])\nconst[hasMore,setHasMore] = useState(false)\n\n\n    useEffect(()=>{\n        setLoading(true)\n        setError(false)\n\n        let cancel\n        axios({\n            methode:\"GET\",\n            url:\"http://openlibrary.org/search.json\",\n            params:{q:query, page:pageNumber}, // that how they called id \"params\",\"q\",\"page\"\n            cancelToken: new axios.CancelToken(c=> cancel = c)\n        }).then(res=> {\n            console.log(res.data)\n            setBooks(prevBooks => {\n                return [...new Set([...prevBooks,...res.data.docs.map(t=>t.title)])] //unique set\n                console.log(res.data)\n            })\n            setHasMore(res.data.length > 0)\n            setLoading(false)\n            setError(false)\n        }).catch(e=> {\n            if(axios.isCancel(e)) return //this is meant to ignore all the cancellation we meant to cancel\n            setError(true)\n        })\n        return () => cancel()\n    },[query,pageNumber])\n\n    useEffect(()=>{\n        setBooks([])\n    },[query])\n\n    return{loading,error,hasMore,books}\n\n}"]},"metadata":{},"sourceType":"module"}